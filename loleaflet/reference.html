<!DOCTYPE html>
<html>
<head>


	<title>Documentation - Leaflet - a JavaScript library for interactive maps</title>

	<meta charset="utf-8" />



	<meta name="viewport" content="width=device-width, initial-scale=1.0">



	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

	<link rel="stylesheet" href="docs/css/normalize.css" />
	<link rel="stylesheet" href="docs/css/main.css" />

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,300' rel='stylesheet' type='text/css'>

	<script src="docs/highlight/highlight.pack.js"></script>
	<script src="docs/js/jquery-2.1.4.min.js"></script>
	<link rel="stylesheet" href="docs/highlight/styles/github-gist.css" />

</head>
<body class="api-page">

<div class="container">


<h2>API Reference</h2>

<div id="toc" class="clearfix">
 	<div class="toc-col">
		<h4 style="color:red;">LOLeaflet API</h4>
		<ul>
			<li><a href="#loleaflet-initialization">Initialization</a></li>
			<li><a href="#loleaflet-general">General</a></li>
			<li><a href="#loleaflet-toolbar">Toolbar</a></li>
			<li><a href="#loleaflet-page">Page oriented</a></li>
			<li><a href="#loleaflet-part">Part oriented</a></li>
			<li><a href="#loleaflet-events">Events</a></li>
			<li><a href="#loleaflet-object-values">Object values</a></li>
			<li><a href="#loleaflet-uno-commands">Uno commands</a></li>
		</ul>
	</div>
	<div class="toc-col last-col">
		<h4 style="color:red;">PostMessage API</h4>
		<ul>
			<li><a href="#loleaflet-postmessage-initialization">Initialization</a></li>
			<li><a href="#loleaflet-postmessage-query">Query API</a></li>
			<li><a href="#loleaflet-postmessage-sessions">Session Management</a></li>
			<li><a href="#loleaflet-postmessage-actions">Actions</a></li>
			<li><a href="#loleaflet-postmessage-misc">Miscellaneous</a></li>
		</ul>
	</div>
</div>

<!--<a href="#toc" id="back-to-top">&uarr;</a>-->

<hr />
<p>This reference reflects <strong>LOLeaflet master</strong>.</p>

<h2 id="loleaflet-loleaflet">LOLeaflet</h2>

<h3 id="loleaflet-initialization">Initialization</h3>

<h4>Usage example</h4>

<pre><code class="javascript">
var map = L.map('map', {
    doc: 'file:///path/to/document',
    server: 'wss://localhost',
    documentContainer: 'document-container'
});</code></pre>

<h4 class="left">Creation</h4>

<table data-id='map'>
	<tr>
		<th>Factory</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>L.map</b>(
			<nobr>&lt;HTMLElement|String&gt; <i>id</i>,</nobr>
			<nobr>&lt;<a href="#map-options">Map options</a>&gt; <i>options?</i> )</nobr>
		</code></td>


		<td>Instantiates a map object given a div element (or its id) and optionally an object literal with map options described below.</td>
	</tr>
</table>

<h4>Options</h4>

<h5>These are the options intended to be used for loleaflet, using any additional options from Leaflet might cause some
unexpected behaviour.</h5>

<table data-id='map'>
	<tr>
		<th>Option</th>
		<th>Type</th>
		<th>Default</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>doc</b></code></td>
		<td><code>String</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>Document URL, the server should be able to access the document.</td>
	</tr>
	<tr>
		<td><code><b>server</b></code></td>
		<td><code>String</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>The websocket server hosting loolwsd using the <code>ws:</code> protocol.
		    Example: wss://localhost:9980</td>
	</tr>
	<tr>
		<td><code><b>webserver</b></code></td>
		<td><code>String</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>The webserver access to hosting loolwsd.  Normally it is
		    derived from 'server', but can be overridden with an own
		    value in case of proxying.  Example: http://localhost:9980</td>
	</tr>
	<tr>
		<td><code><b>permission</b></code></td>
		<td><code>String</code></td>
		<td><code><span class="literal">'view'</span></code></td>
        <td>The document's <a href="#documentpermission-values">permission</a>.</td>
	</tr>
	<tr>
		<td><code><b>timestamp</b></code></td>
		<td><code>String</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>A timestamp of the last modification to the document.</td>
	</tr>
	<tr>
		<td><code><b>documentContainer</b></code></td>
		<td><code>String / DOM element</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>An outer div, containing the map div, that is used internally for the creation of the toolbar.</td>
	</tr>
	<tr>
		<td><code><b>toolbarContainer</b></code></td>
		<td><code>String / DOM element</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>A div used by the default toolbar elements (bold, italic, search, etc.) in loleaflet. If you implement
           your own toolbar and use controls that do not require a toolbar (like the dialog or scroll control) you
          can ignore this.</td>
	</tr>
	<tr>
		<td><code><b>renderingOptions</b></code></td>
		<td><code>Object</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>Enables the continuous, web view, of the document, see the UNO commands below for this parameter.</td>
	</tr>
	<tr>
		<td><code><b>print</b></code></td>
		<td><code>Boolean</code></td>
		<td><code><span class="literal">true</span></code></td>
		<td>Whether the print handler is active (for Chrome).</td>
	</tr>
	<tr>
		<td><code><b>autoFitWidth</b></code></td>
		<td><code>Boolean</code></td>
		<td><code><span class="literal">true</span></code></td>
		<td>Whether the document is automatically zoomed so that the width fits the viewing area when
            the window is resized. The document will not be zoomed in more than map.options.zoom.</td>
	</tr>
	<tr>
		<td><code><b>zoom</b></code></td>
		<td><code>Number</code></td>
		<td><code><span class="literal">10</span></code></td>
		<td>Default zoom level in which the document will be loaded.</td>
	</tr>
	<tr>
		<td><code><b>tileWidthTwips</b></code></td>
		<td><code>Number</code></td>
		<td><code><span class="literal">3840</span></code></td>
		<td>Default tile width in twips (how much of the document is covered horizontally in a 256x256 pixels tile).
            Unless you know what you are doing, this should not be modified;
	    this means twips value for 256 pixels at 96dpi.</td>
	</tr>
	<tr>
		<td><code><b>tileHeightTwips</b></code></td>
		<td><code>Number</code></td>
		<td><code><span class="literal">3840</span></code></td>
		<td>Default tile height in twips (how much of the document is covered vertically in a 256x256 pixels tile).
            Unless you know what you are doing, this should not be modified;
	    this means twips value for 256 pixels at 96dpi.</td>
	</tr>
	<tr>
		<td><code><b>defaultZoom</b></code></td>
		<td><code>Number</code></td>
		<td><code><span class="literal">10</span></code></td>
		<td>The zoom level at which the tile size in twips equals the default size (3840 x 3840).
            Unless you know what you are doing, this should not be modified.</td>
	</tr>
    <tr>
		<td><code><b>cursorURL</b></code></td>
		<td><code>String</code></td>
		<td><code><span class="literal">undefined</span></code></td>
		<td>The path (local to the server) where custom cursor files are stored.</td>
	</tr>
</table>

<h3 id="loleaflet-general">General</h3>

<p>General methods for document interaction.</p>

<table data-id='map'>
	<tr>
		<th>Method</th>
		<th>Returns</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>search</b>(
			<nobr>&lt;String&gt; <i>phrase</i>,</nobr>
			<nobr>&lt;Boolean&gt; <i>backward?</i> )</nobr>
		</code></td>
		<td><code>undefined</code></td>
		<td>Searches for the given phrase downward from the current top border of the viewing area.
        Or backwards if specified.</td>
	</tr>
	<tr>
		<td><code><b>highlightAll</b>(
			<nobr>&lt;String&gt; <i>phrase</i>,</nobr>
		</code></td>
		<td><code>undefined</code></td>
		<td>Highlights all the occurrences of the given phrase. Please note that
			this adds an extra layer for the highlights, so it is possible to
			see both all the highlighted phrase, and the current selection at
			the same time.</td>
	</tr>
	<tr>
		<td><code><b>setPermission</b>(
			<nobr>&lt;<a href="#documentpermission-values">DocumentPermissionValues</a>&gt; <i>documenPermission</i>)</nobr>
		</code></td>
		<td><code>undefined</code></td>
		<td>Sets the permission of the document.</td>
	</tr>
	<tr>
        <td><code><b>getDocSize</b>()</code></td>
		<td><code><a href="#point">Point</a></code></td>
		<td>Returns the document size.</td>
	</tr>
	<tr>
        <td><code><b>getDocType</b>()</code></td>
		<td><code><nobr><a href="#documenttype-values">DocumentTypeValues</a></nobr></code></td>
		<td>Returns the document type.</td>
	</tr>
	<tr>
        <td><code><b>getPageSizes</b>()</code></td>
        <td><code><nobr>{twips: <a href="#bounds">[Bounds]</a>,<br>
                pixels: <a href="#bounds">[Bounds]</a>}</nobr></code></td>
		<td>Returns an object describing the size of each page in twips and pixels.</td>
	</tr>
	<tr>
        <td><code><b>scroll</b>(
			<nobr>&lt;Number&gt;<i>x</i>,</nobr>
			<nobr>&lt;Number&gt;<i>y</i>,</nobr>
			<nobr>&lt;<a href="#scroll-options">ScrollOptions</a>&gt;<i>Options</i>)</nobr>
        </code></td>
		<td><code><nobr>undefined</nobr></code></td>
		<td>Scroll right by 'x' and down by 'y' (or left and up if negative).</td>
	</tr>
	<tr>
        <td><code><b>scrollDown</b>(
			<nobr>&lt;Number&gt;<i>y</i>,</nobr>
			<nobr>&lt;<a href="#scroll-options">ScrollOptions</a>&gt;<i>Options</i>)</nobr>
        </code></td>
		<td><code><nobr>undefined</nobr></code></td>
		<td>Scroll down by 'y' (or up if negative).</td>
	</tr>
	<tr>
        <td><code><b>scrollRight</b>(
			<nobr>&lt;Number&gt;<i>x</i>,</nobr>
			<nobr>&lt;<a href="#scroll-options">ScrollOptions</a>&gt;<i>Options</i>)</nobr>
        </code></td>
		<td><code><nobr>undefined</nobr></code></td>
		<td>Scroll right by 'x' (or left if negative).</td>
	</tr>
	<tr>
        <td><code><b>scrollTop</b>(
			<nobr>&lt;Number&gt;<i>y</i>,</nobr>
			<nobr>&lt;<a href="#scroll-options">ScrollOptions</a>&gt;<i>Options</i>)</nobr>
        </code></td>
		<td><code><nobr>undefined</nobr></code></td>
		<td>Scroll to 'y' offset relative to the beginning of the document.</td>
	</tr>
	<tr>
        <td><code><b>scrollLeft</b>(
			<nobr>&lt;Number&gt;<i>x</i>,</nobr>
			<nobr>&lt;<a href="#scroll-options">ScrollOptions</a>&gt;<i>Options</i>)</nobr>
        </code></td>
		<td><code><nobr>undefined</nobr></code></td>
		<td>Scroll to 'x' offset relative to the beginning of the document.</td>
	</tr>
	<tr>
        <td><code><b>scrollOffset</b>()</code></td>
		<td><code><nobr><a href="#point">Point</a></nobr></code></td>
		<td>Returns the scroll offset relative to the beginning of the document.</td>
	</tr>
	<tr>
        <td><code><b>getPreview</b>(
            &lt;Object&gt;<i>id</i>,<br>
			&lt;Number&gt;<i>index</i>,<br>
			&lt;Number&gt;<i>maxWidth</i>,<br>
			&lt;Number&gt;<i>maxHeight</i>,<br>
            <nobr>&lt;<a href="#getpreview-options">PreviewOptions</a>&gt;<i>options?</i>)</nobr>
		</code></td>
		<td><code>undefined</code></td>
		<td>Triggers the creation of a preview with the given id, of maximum maxWidth X maxHeight size, of the
            page / part with number 'index', keeping the original ratio.</td>
	</tr>
	<tr>
		<td><code><b>getCustomPreview</b>(
            &lt;Object&gt;<i>id</i>,<br>
			&lt;Number&gt;<i>part</i>,<br>
			&lt;Number&gt;<i>width</i>,<br>
			&lt;Number&gt;<i>height</i>,<br>
			&lt;Twips&gt;<i>tilePosX</i>,<br>
			&lt;Twips&gt;<i>tilePosY</i>,<br>
			&lt;Twips&gt;<i>tileWidth</i>,<br>
			&lt;Twips&gt;<i>tileHeight</i>,<br>
            <nobr>&lt;<a href="#getpreview-options">PreviewOptions</a>&gt;<i>options?</i>)</nobr>
		</code></td>
		<td><code>undefined</code></td>
		<td>Triggers the creation of a preview with the given id, of width X height size, of the
            [(tilePosX,tilePosY), (tilePosX + tileWidth, tilePosY + tileHeight)] section of the document.</td>
	</tr>
	<tr>
		<td><code><b>removePreviewUpdate</b>(
			<nobr>&lt;Object&gt;<i>id</i>)</nobr>
        </code></td>
		<td><code>undefined</code></td>
		<td>Cancels the automatic update for the preview defined by 'id'.</td>
	</tr>
	<tr>
		<td><code><b>fitWidthZoom</b>(
			<nobr>&lt;Number&gt;<i>maxZoom</i>)</nobr>
        </code></td>
		<td><code>undefined</code></td>
		<td>Zooms in or out so that the document's width fits the viewing area. The document will not zoom in more
            than `maxZoom` if the parameter is provided.</td>
	</tr>
</table>

<h4 id="scroll-options">ScrollOptions</h4>

<table data-id='values'>
	<tr>
		<th class="width100">property</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>update</b></code></td>
		<td><code>Boolean</code></td>
        <td>Whether the <a href="#updatescrolloffset-event">update-scroll-offset</a> event is fired.</td>
	</tr>
</table>

<h4 id="getpreview-options">PreviewOptions</h4>

<table data-id='values'>
	<tr>
		<th class="width100">property</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>autoUpdate</b></code></td>
		<td><code>Boolean</code></td>
        <td>Whether a new preview is generated automatically when it becomes
        invalid.</td>
	</tr>
	<tr>
	  <td><code><b>broadcast</b></code></td>
	  <td><code>Boolean</code></td>
          <td>Whether new preview should be broadcasted to other clients of same
            document.</td>
	</tr>
</table>

<h3 id="loleaflet-toolbar">Toolbar</h3>

<p>Toolbar methods.</p>

<table data-id='map'>
	<tr>
		<th>Method</th>
		<th>Returns</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>getToolbarCommandValues</b>(
			<nobr>&lt;<a href="#toolbarcommand-values">ToolbarCommandValues</a>&gt; <i>unoCommand</i>)</nobr>
		</code></td>
		<td><code>Object</code></td>
		<td>Returns a JSON mapping of the possible values.</td>
	</tr>
	<tr>
		<td><code><b>toggleCommandState</b>(
			<nobr>&lt;<a href="#commandstatechanged-values">CommandValues</a>&gt; <i>unoCommand</i>)</nobr>
		</code></td>
		<td><code>undefined</code></td>
		<td>Toggles the state for the given UNO command.</td>
	</tr>
	<tr>
		<td><code><b>saveAs</b>(
			<nobr>&lt;String&gt;<i>url</i>,</nobr>
            <nobr>&lt;String&gt;<i>format?</i>,</nobr>
			<nobr>&lt;String&gt;<i>options?</i>)</nobr>
		</code></td>
		<td><code>undefined</code></td>
        <td>Save the document as "format" at the given URL by applying the filter options.</td>
	</tr>
	<tr>
		<td><code><b>downloadAs</b>(
			<nobr>&lt;String&gt;<i>name</i>,</nobr>
			<nobr>&lt;String&gt;<i>format?</i>,</nobr>
            <nobr>&lt;String&gt;<i>options?</i>)</nobr>
		</code></td>
		<td><code>undefined</code></td>
        <td>Download the document as "format" with the name "name" by applying the filter options.</td>
	</tr>
	<tr>
		<td><code><b>print</b>()</code></td>
		<td><code>undefined</code></td>
        <td>Opens the browser's print dialog or prompts the user to download a PDF version of the document.</td>
	</tr>
	<tr>
		<td><code><b>cellEnterString</b>(
            <nobr>&lt;String&gt;<i>formula</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Enters a string of text in the selected cell.</td>
	</tr>
	<tr>
		<td><code><b>insertFile</b>(
            <nobr>&lt;File&gt;<i>file</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Insert a file (graphic) in the document.</td>
	</tr>
	<tr>
		<td><code><b>applyFont</b>(
            <nobr>&lt;String&gt;<i>fontName</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Applies a font.</td>
	</tr>
	<tr>
		<td><code><b>applyFontSize</b>(
            <nobr>&lt;Number&gt;<i>fontSize</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Applies a font size.</td>
	</tr>
	<tr>
		<td><code><b>applyStyle</b>(
            <nobr>&lt;String&gt;<i>style</i>,</nobr>
            <nobr>&lt;String&gt;<i>styleFamily</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Applies a style from a style family.</td>
	</tr>
	<tr>
		<td><code><b>renderFont</b>(
            <nobr>&lt;String&gt;<i>fontName</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Renders the given font in the smallest rectangle it can fit in.</td>
	</tr>
	<tr>
		<td><code><b>sendUnoCommand</b>(
			<nobr>&lt;<a href="#loleaflet-uno-commands">String</a>&gt; <i>unoCommand</i>,</nobr>
			<nobr>&lt;<a href="#loleaflet-uno-commands">Object</a>&gt; <i>param</i>)</nobr></code></td>
		<td><code>undefined</code></td>
        <td>Sends a <a href="#loleaflet-uno-commands">uno command</a> with the given parameter to LOKit.</td>
	</tr>
</table>

<h3 id="loleaflet-page">Page oriented</h3>

<p>Methods for page oriented documents.</p>

<table data-id='map'>
	<tr>
		<th>Method</th>
		<th>Returns</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>getCurrentPageNumber</b>()</code></td>
		<td><code>Number</code></td>
		<td>Number of the current page.</td>
	</tr>
	<tr>
		<td><code><b>getNumberOfPages</b>()</code></td>
		<td><code>Number</code></td>
		<td>Total number of pages.</td>
	</tr>
	<tr>
		<td><code><b>goToPage</b>(
			<nobr>&lt;Number&gt;<i>pageNumber</i>)</nobr>
        </code></td>
		<td><code>undefined</code></td>
		<td>Scrolls to the beginning of the given page.</td>
	</tr>
</table>

<h3 id="loleaflet-part">Part oriented</h3>

<p>Methods for page oriented documents.</p>

<table data-id='map'>
	<tr>
		<th>Method</th>
		<th>Returns</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>getCurrentPartNumber</b>()</code></td>
		<td><code>Number</code></td>
		<td>Number of the current part.</td>
	</tr>
	<tr>
		<td><code><b>getNumberOfParts</b>()</code></td>
		<td><code>Number</code></td>
		<td>Total number of parts.</td>
	</tr>
	<tr>
		<td><code><b>setPart</b>(
			<nobr>&lt;Number&gt;<i>partNumber</i>)</nobr>
        </code></td>
		<td><code>undefined</code></td>
		<td>Select a specific part.</td>
	</tr>
</table>

<h3 id="loleaflet-events">Events</h3>

<p>You can subscribe to the following events using <a href="#events">these methods</a>.</p>

<table data-id='map'>
	<tr>
		<th>Event</th>
		<th>Data</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>cellformula</b></code></td>
		<td><code><a href="#cellformula-event">CellFormulaEvent</a></code></td>
		<td>Fired when the content of the selected cell changes.</td>
	</tr>
	<tr>
		<td><code><b>commandresult</b></code></td>
		<td><code><a href="#commandresult-event">CommandResultEvent</a></code></td>
		<td>Fired when a dispatched uno command or the 'saveas' command has finished.</td>
	</tr>
	<tr>
		<td><code><b>commandstatechanged</b></code></td>
		<td><code><a href="#commandstatechanged-event">CommandStateChangedEvent</a></code></td>
		<td>Fired when the state of a command such as .uno:Bold changes.</td>
	</tr>
	<tr>
		<td><code><b>locontextmenu</b></code></td>
		<td><code><a href="#locontextmenu-event">LOContextMenuEvent</a></code></td>
		<td>Fired when the user's action invoked a context menu (via a
		    right-click).  It contains the structure of the menu.</td>
	</tr>
	<tr>
		<td><code><b>docsize</b></code></td>
		<td><code><a href="#docsize-event">DocumentSizeEvent</a></code></td>
		<td>Fired when the document size changes.</td>
	</tr>
	<tr>
		<td><code><b>error</b></code></td>
		<td><code><a href="#error-event">ErrorEvent</a></code></td>
		<td>Fired on server or client error.</td>
	</tr>
	<tr>
		<td><code><b>hyperlinkclicked</b></code></td>
		<td><code><a href="#hyperlinkclicked-event">HyperlinkClickedEvent</a></code></td>
		<td>Fired when the user clicks a hyperlink in the document.</td>
	</tr>
	<tr>
		<td><code><b>pagenumberchanged</b></code></td>
		<td><code><a href="#pagenumberchanged-event">PageNumberChangedEvent</a></code></td>
		<td>Fired when the number of pages changes.</td>
	</tr>
	<tr>
		<td><code><b>print</b></code></td>
		<td><code><a href="#print-event">PrintEvent</a></code></td>
		<td>Fired when the URL for the PDF export is ready.</td>
	</tr>
	<tr>
		<td><code><b>renderfont</b></code></td>
		<td><code><a href="#renderfont-event">RenderFontEvent</a></code></td>
		<td>Fired when the font rendering is ready.</td>
	</tr>
	<tr>
		<td><code><b>search</b></code></td>
		<td><code><a href="#search-event">SearchEvent</a></code></td>
		<td>Fired when the search result is ready.</td>
	</tr>
	<tr>
		<td><code><b>scrollby</b></code></td>
		<td><code><a href="#scrollby-event">ScrollByEvent</a></code></td>
		<td>Fired when the document is panned with the keyboard.</td>
	</tr>
	<tr>
		<td><code><b>scrollto</b></code></td>
		<td><code><a href="#scrollto-event">ScrollToEvent</a></code></td>
		<td>Fired when the cursor goes out of the viewing area.</td>
	</tr>
	<tr>
		<td><code><b>statusindicator</b></code></td>
		<td><code><a href="#statusindicator-event">StatusIndicator</a></code></td>
		<td>Fired when leaflet is initialized, during document loading or on reconnection.</td>
	</tr>
	<tr>
		<td><code><b>tilepreview</b></code></td>
		<td><code><a href="#tilepreview-event">TilePreviewEvent</a></code></td>
		<td>Fired when the rendering of a requested preview is ready.</td>
	</tr>
	<tr>
		<td><code><b>updateparts</b></code></td>
		<td><code><a href="#updateparts-event">UpdatePartsEvent</a></code></td>
		<td>Fired when a new part has been selected.</td>
	</tr>
	<tr>
		<td><code><b>updatepermission</b></code></td>
		<td><code><a href="#permission-event">PermissionEvent</a></code></td>
		<td>Fired when the document permission changes.</td>
	</tr>
	<tr>
		<td><code><b>updatescrolloffset</b></code></td>
		<td><code><a href="#updatescrolloffset-event">UpdateScrollOffsetEvent</a></code></td>
		<td>Fired when the document is panned and the scrollbars should be moved along with the document.</td>
	</tr>
	<tr>
		<td><code><b>updatetoolbarcommandvalues</b></code></td>
		<td><code><a href="#updatetoolbarcommandvalues-event">UpdateToolbarCommandValuesEvent</a></code></td>
		<td>Fired when the document is loaded and contains the available command values for Font, FontSize, Style, etc.</td>
	</tr>
</table>

<h4 id="cellformula-event">CellFormulaEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>formula</b></code></td>
		<td><code>String</code></td>
		<td>The formula from the selected cell.</td>
	</tr>
</table>

<h4 id="commandresult-event">CommandResult</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>commandName</b></code></td>
		<td><code><a href="#commandstatechanged-values">CommandStateChangedValues</a></code></td>
		<td>UNO command or 'saveas'.</td>
	</tr>
	<tr>
		<td><code><b>success</b></code></td>
		<td><code>Boolean or undefined</code></td>
		<td>Returns the status code of the command execution, or
		    undefined if the result is not provided, and the command
		    only indicates that the operation has finished.</td>
	</tr>
</table>

<h4 id="commandstatechanged-event">CommandStateChangedEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>commandName</b></code></td>
		<td><code><a href="#commandstatechanged-values">CommandStateChangedValues</a></code></td>
		<td>UNO command.</td>
	</tr>
	<tr>
		<td><code><b>state</b></code></td>
		<td><code><a href="#commandstate-values">CommandStateValues</a></code></td>
		<td>UNO command state.</td>
	</tr>
</table>

<h4 id="locontextmenu-event">LOContextMenuEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>menu</b></code></td>
		<td><code>String</code></td>
		<td>List of the menu entries.  The structure looks like:<br/>
<code>
{ "text": "label text1", "type": "command", "command": ".uno:Something1", "enabled": "true" },
{ "text": "label text2", "type": "command", "command": ".uno:Something2", "enabled": "false" },
{ "type": "separator" },
{ "text": "label text2", "type": "menu", "menu": [ { ... }, { ... }, ... ] },
...
</code>
		</td>
	</tr>
</table>

<h4 id="docsize-event">DocumentSizeEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>x</b></code></td>
		<td><code>Number</code></td>
		<td>Document width in pixels.</td>
	</tr>
	<tr>
		<td><code><b>y</b></code></td>
		<td><code>Number</code></td>
		<td>Document height in pixels.</td>
	</tr>
</table>

<h4 id="error-event">ErrorEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>id</b></code></td>
		<td><code>Number</code></td>
		<td>Identificator of the error that can be used as indication
		of error message to present to the user.</td>
	</tr>
	<tr>
		<td><code><b>msg</b></code></td>
		<td><code>String</code></td>
		<td>If present, the error message.</td>
	</tr>
	<tr>
		<td><code><b>cmd</b></code></td>
		<td><code>String</code></td>
		<td>If present, the server command that caused the error.</td>
	</tr>
	<tr>
		<td><code><b>kind</b></code></td>
		<td><code>String</code></td>
		<td>If present, the kind of error associated with the command.</td>
	</tr>
</table>

The <code>id</code> property of ErrorEvent can have the following values:

<table data-id='events'>
	<tr>
		<th>value</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>1</b></code></td>
		<td>Internal error. Things still may work to some extent, but
		the session becomes unreliable.</td>
	</tr>
	<tr>
		<td><code><b>2</b></code></td>
		<td>Document couldn't be loaded.</td>
	</tr>
	<tr>
		<td><code><b>3</b></code></td>
		<td>Socket connection error.</td>
	</tr>
	<tr>
		<td><code><b>4</b></code></td>
		<td>Socket connection was closed.</td>
	</tr>
	<tr>
		<td><code><b>5</b></code></td>
		<td>Document couldn't be saved.</td>
	</tr>
</table>

<h4 id="hyperlinkclicked-event">HyperlinkClickedEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>url</b></code></td>
		<td><code>String</code></td>
		<td>Target URL of the hyperlink that the user clicked in the
		    document.</td>
	</tr>
</table>

<h4 id="pagenumberchanged-event">PageNumberChangedEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>currentPage</b></code></td>
		<td><code>Number</code></td>
		<td>The current page in the document.</td>
	</tr>
	<tr>
		<td><code><b>pages</b></code></td>
		<td><code>Number</code></td>
		<td>The number of pages.</td>
	</tr>
	<tr>
		<td><code><b>docType</b></code></td>
		<td><code><a href="#documenttype-values">DocumentTypeValues</a></code></td>
		<td>The document type.</td>
	</tr>
</table>

<h4 id="print-event">PrintEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>url</b></code></td>
        <td><code>String</code></td>
		<td>An URL for the PDF exported document.</td>
	</tr>
</table>

<h4 id="renderfont-event">RenderFontEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>font</b></code></td>
        <td><code>String</code></td>
		<td>Font name.</td>
	</tr>
	<tr>
		<td><code><b>img</b></code></td>
        <td><code>String</code></td>
		<td>The image data URL.</td>
	</tr>
</table>

<h4 id="search-event">SearchEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>originalPhrase</b></code></td>
		<td><code>String</code></td>
		<td>The phrase that has been searched for</td>
	</tr>
	<tr>
		<td><code><b>count</b></code></td>
		<td><code>Number</code></td>
		<td>Number of search results</td>
	</tr>
	<tr>
		<td><code><b>results</b></code></td>
		<td><code><a href="#search-result">SearchResult[]</a></code></td>
		<td>An array representing the selections of the search results in the document.</td>
	</tr>
</table>

<h4 id="scrollby-event">ScrollByEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>x</b></code></td>
		<td><code>Number</code></td>
		<td>Scroll right by x pixels, or left if negative.</td>
	</tr>
	<tr>
		<td><code><b>y</b></code></td>
		<td><code>Number</code></td>
		<td>Scroll down by y pixels, or up if negative.</td>
	</tr>
</table>

<h4 id="scrollto-event">ScrollToEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>x</b></code></td>
		<td><code>Number</code></td>
		<td>View's left border position in pixels.</td>
	</tr>
	<tr>
		<td><code><b>y</b></code></td>
		<td><code>Number</code></td>
		<td>View's top border position in pixels.</td>
	</tr>
</table>

<h4 id="statusindicator-event">StatusIndicatorEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>statusType</b></code></td>
		<td><code><a href="#statusindicator-values">StatusIndicatorValues</a></code></td>
		<td>Status type.</td>
	</tr>
	<tr>
		<td><code><b>value</b></code></td>
		<td><code>Number</code></td>
		<td>If present, a number for 0 to 100 representing the loading status.</td>
	</tr>
</table>

<h4 id="tilepreview-event">TilePreviewEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>tile</b></code></td>
		<td><code>Image</code></td>
		<td>The actual preview.</td>
	</tr>
	<tr>
		<td><code><b>id</b></code></td>
		<td><code>Object</code></td>
		<td>Preview id.</td>
	</tr>
	<tr>
		<td><code><b>width</b></code></td>
		<td><code>Number</code></td>
		<td>Image width.</td>
	</tr>
	<tr>
		<td><code><b>height</b></code></td>
		<td><code>Number</code></td>
		<td>Image height.</td>
	</tr>
	<tr>
		<td><code><b>docType</b></code></td>
		<td><code><a href="#documenttype-values">DocumentTypeValues</a></code></td>
		<td>The document type.</td>
	</tr>
	<tr>
		<td><code><b>part</b></code></td>
		<td><code>Number</code></td>
		<td>If the preview is for a whole part.</td>
	</tr>
</table>

<h4 id="updateparts-event">UpdatePartsEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>selectedPart</b></code></td>
		<td><code>Number</code></td>
		<td>The currently selected part.</td>
	</tr>
	<tr>
		<td><code><b>parts</b></code></td>
		<td><code>Number</code></td>
		<td>The number of parts in the document.</td>
	</tr>
	<tr>
		<td><code><b>docType</b></code></td>
		<td><code><a href="#documenttype-values">DocumentTypeValues</a></code></td>
		<td>The document type.</td>
	</tr>
	<tr>
		<td><code><b>partNames</b></code></td>
		<td><code>String[]</code></td>
		<td>If present, an array containing slides' / spreadsheets' names.</td>
	</tr>
</table>

<h4 id="permission-event">PermissionEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>perm</b></code></td>
		<td><code><a href="#documentpermission-values">DocumentPermission</a></code></td>
		<td>Document permission.</td>
	</tr>
</table>

<h4 id="updatescrolloffset-event">UpdateScrollOffsetEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>x</b></code></td>
		<td><code>Number</code></td>
		<td>Difference in pixels between the document's left border and view's left border.</td>
	</tr>
	<tr>
		<td><code><b>y</b></code></td>
		<td><code>Number</code></td>
		<td>Difference in pixels between the document's top border and view's top border.</td>
	</tr>
</table>

<h4 id="updatetoolbarcommandvalues-event">UpdateToolbarCommandValuesEvent</h4>

<table data-id='events'>
	<tr>
		<th class="width100">property</th>
		<th>type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>commandName</b></code></td>
		<td><code><a href="#toolbarcommand-values">ToolbarCommandValues</a></code></td>
		<td>UNO command.</td>
	</tr>
	<tr>
		<td><code><b>commandValues</b></code></td>
		<td><code>Object</code></td>
		<td>JSON mapping of the possible values.</td>
	</tr>
</table>

<h3 id="loleaflet-object-values">Object values</h3>

<p>A list of possible values for different event object properties.</p>

<h4 id="search-result">SearchResult</h4>

<table data-id='values'>
	<tr>
		<th class="width100">property</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>part</b></code></td>
		<td><code>Number</code></td>
        <td>The part in which the selection lies.</td>
	</tr>
	<tr>
		<td><code><b>rectangles</b></code></td>
        <td><code><a href="#bounds">Bounds[]</a></code></td>
        <td>Selection bounds in pixels.</td>
	</tr>
</table>

<h4 id="documentpermission-values">DocumentPermissionValues</h4>

<table data-id='values'>
	<tr>
		<th class="width100">value</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>'edit'</b></code></td>
		<td><code>String</code></td>
		<td>The document can be edited, dragging is disabled and mouse selection is active.</td>
	</tr>
	<tr>
		<td><code><b>'view'</b></code></td>
		<td><code>String</code></td>
		<td>The document is in viewing mode, dragging is enabled by default and by clicking in it, editing mode is entered.</td>
	</tr>
    <tr>
		<td><code><b>'readonly'</b></code></td>
		<td><code>String</code></td>
		<td>The document is in read-only mode, dragging is enabled by default.</td>
	</tr>
</table>

<h4 id="commandstatechanged-values">CommandStateChangedValues</h4>

<table data-id='values'>
	<tr>
		<th class="width100">value</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>'.uno:Bold'</b></code></td>
		<td><code>String</code></td>
		<td>Bold.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:Italic'</b></code></td>
		<td><code>String</code></td>
		<td>Italic.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:Underline'</b></code></td>
		<td><code>String</code></td>
		<td>Underline.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:Strikeout'</b></code></td>
		<td><code>String</code></td>
		<td>Strikeout.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:LeftPara'</b></code></td>
		<td><code>String</code></td>
		<td>Align left.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:CenterPara'</b></code></td>
		<td><code>String</code></td>
		<td>Center horizontally.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:RightPara'</b></code></td>
		<td><code>String</code></td>
		<td>Align right.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:JustifyPara'</b></code></td>
		<td><code>String</code></td>
		<td>Justified.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:IncrementIndent'</b></code></td>
		<td><code>String</code></td>
		<td>Increment indent.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:DecrementIndent'</b></code></td>
		<td><code>String</code></td>
		<td>Decrement indent.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:StyleApply'</b></code></td>
		<td><code>String</code></td>
		<td>Style related uno command.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:CharFontName'</b></code></td>
		<td><code>String</code></td>
		<td>Font related uno command.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:FontHeight'</b></code></td>
		<td><code>String</code></td>
		<td>Font size related uno command.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:ModifiedStatus'</b></code></td>
		<td><code>String</code></td>
		<td>If the document is now marked as modified. The value is
			'true' when the document is marked as modified, and
			'false' the user e.g. undoes all the changes or
			saves the document.</td>
	</tr>
</table>

<h4 id="commandstate-values">CommandStateValues</h4>

<table data-id='values'>
	<tr>
		<th class="width100">value</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>'true'</b></code></td>
		<td><code>String</code></td>
		<td>For '.uno:Bold', '.uno:Italic', etc.</td>
	</tr>
	<tr>
		<td><code><b>'false'</b></code></td>
		<td><code>String</code></td>
		<td>For '.uno:Bold', '.uno:Italic', etc.</td>
	</tr>
	<tr>
		<td><code><b>styleName</b></code></td>
		<td><code>String</code></td>
		<td>For '.uno:StyleApply'.</td>
	</tr>
	<tr>
		<td><code><b>fontName</b></code></td>
		<td><code>String</code></td>
		<td>For '.uno:CharFontName'.</td>
	</tr>
	<tr>
		<td><code><b>fontSize</b></code></td>
		<td><code>String</code></td>
		<td>For '.uno:FontHeight'.</td>
	</tr>
</table>

<h4 id="documenttype-values">DocumentTypeValues</h4>

<table data-id='values'>
	<tr>
		<th class="width100">value</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>'text'</b></code></td>
		<td><code>String</code></td>
		<td>Text document, usually handled by Writer.</td>
	</tr>
	<tr>
		<td><code><b>'presentation'</b></code></td>
		<td><code>String</code></td>
		<td>Text document, usually handled by Impress.</td>
	</tr>
	<tr>
		<td><code><b>'spreadsheet'</b></code></td>
		<td><code>String</code></td>
		<td>Text document, usually handled by Calc.</td>
	</tr>
	<tr>
		<td><code><b>'drawing'</b></code></td>
		<td><code>String</code></td>
		<td>Text document, usually handled by Draw.</td>
	</tr>
	<tr>
		<td><code><b>'other'</b></code></td>
		<td><code>String</code></td>
		<td>Other document type.</td>
	</tr>
</table>

<h4 id="statusindicator-values">StatusIndicatorValues</h4>

<table data-id='values'>
	<tr>
		<th class="width100">value</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>'start'</b></code></td>
		<td><code>String</code></td>
		<td>Fired when the progress broadcast is being started.</td>
	</tr>
	<tr>
		<td><code><b>'setvalue'</b></code></td>
		<td><code>String</code></td>
		<td>Set a value between 0 and 100.</td>
	</tr>
	<tr>
		<td><code><b>'finish'</b></code></td>
		<td><code>String</code></td>
		<td>The progress is at 100%.</td>
	</tr>
	<tr>
		<td><code><b>'loleafletloaded'</b></code></td>
		<td><code>String</code></td>
		<td>Fired when the code has been initialized.</td>
	</tr>
	<tr>
		<td><code><b>'alltilesloaded'</b></code></td>
		<td><code>String</code></td>
		<td>Fired when all empty tiles have been loaded (fired several times).</td>
	</tr>
	<tr>
		<td><code><b>'initializationcomplete'</b></code></td>
		<td><code>String</code></td>
		<td>Fired when everything that is needed for operating on the
		    document is ready: this._docLayer is defined,
		    statusindicatorfinish was received, .uno:StyleApply was
		    received, .uno:CharFontName was received, and
		    updatepermission was received.</td>
	</tr>
</table>

<h4 id="toolbarcommand-values">ToolbarCommandValues</h4>

<table data-id='values'>
	<tr>
		<th class="width100">value</th>
		<th class="width100">type</th>
		<th>description</th>
	</tr>
	<tr>
		<td><code><b>'.uno:StyleApply'</b></code></td>
		<td><code>String</code></td>
		<td>Style related uno command.</td>
	</tr>
	<tr>
		<td><code><b>'.uno:CharFontName'</b></code></td>
		<td><code>String</code></td>
		<td>Font related uno command.</td>
	</tr>
</table>

<h3 id="loleaflet-uno-commands">Uno command</h3>

<p>A list of common uno commands with their additional parameters.</p>
<pre><code class="javascript">map.sendUnoCommand('.uno:Bold')</code></pre>
<pre><code class="javascript">map.sendUnoCommand('.uno:Color',
{
  "Color": {
    "type": "long",
    "value": 16750848
  }
})</code></pre>

<table data-id='values' id='uno-commands-table'>
	<tr>
		<th class="width100">command</th>
		<th class="width100">parameter</th>
		<th>description</th>
	</tr>
</table>

<h2 id="loleaflet-postmessage">PostMessage API</h2>

<p>PostMessage API is used to interact with parent frame when loleaflet is
  enclosed in one. This is useful for hosts wanting to
  integrate Collabora Online in them.</p>

<p>This API is mostly based
  on <a href="https://wopi.readthedocs.io/en/latest/scenarios/postmessage.html">WOPI
    specification</a> with few extensions/modifications. All messages sent are
  in this form :

<pre><code class="javascript">
{
    "MessageId": "&lt;MessageId&gt;",
    "SendTime": "&lt;Timestamp when message is sent&gt;",
    "Values": {
         "&lt;key&gt;": "&lt;value&gt;"
    }
}
</code></pre>
SendTime is the timestamp returned by browsers' Date.now(). The post messages
sent from the WOPI host should also be in same form.
</p>

<p>It is to be noted that as mentioned in WOPI specs, loleaflet frame will
  ignore all post messages coming from the host frame
  if <code>Host_PostmessageReady</code> has not been received. Further, since
  for embedding Collabora Online as an iframe WOPI implementation is a must,
  it is required that 'PostMessageOrigin' property is present in
  WOPI host's CheckFileInfo response. Otherwise, no post messages will be
  emitted.
<br/>

<h3 id="loleaflet-postmessage-initialization">Initialization</h3>
Editor to WOPI host
<table data-id='postmessage-initialization-from-editor'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>App_LoadingStatus</b></code></td>
		<td><code>
		    <nobr>Status: &lt;String&gt;</nobr>
		    <nobr>DocumentLoadedTime: &lt;Timestamp&gt;</nobr>
		    <nobr>Features: &lt;Dict&gt;</nobr>
		</code></td>
		<td>If Status is <i>Frame_Ready</i>, loleaflet frame is loaded and UI
		    can be shown. <br/>
		    Accompanying keys: <i>Features</i>: This client's capabilities.
		    Supported values are: <i>VersionStates</i>. Tells the host that client supports different version states. See <a href="#loleaflet-postmessage-versioning">Version Restore</a> for more details.<br/>
		    When Status is <i>Document_Loaded</i>, document has been completely
		    loaded and host can also start using PostMessage API.<br/>
		    Accompanying keys:
			<i>DocumentLoadedTime</i><br/>
			When Status is <i>Failed</i>, document hasn't been loaded but host can show the loleaflet frame to present an error for a user.
		</td>
	</tr>
</table>

WOPI host to editor
<table data-id='postmessage-initialization-to-editor'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Host_PostmessageReady</b></code></td>
		<td><code>
		</code></td>
		<td>
		  See WOPI docs for detail.
		</td>
	</tr>
</table>

<h3 id="loleaflet-postmessage-query">Query</h3>
You can query data from the editor using post message API. All responses are
returned with query's MessageId suffixed with '_Resp' as shown below
<br/><br/>
Getters<br/>
WOPI Host to Editor
<table data-id='postmessage-query-getters'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Get_Views</b></code></td>
		<td><code>
		</code></td>
		<td>
		Queries the editor for currently active views of the document. Response is returned in form of <code>Get_Views_Resp</code>
		</td>
	</tr>
	<tr>
		<td><code><b>Get_Export_Formats</b></code></td>
		<td><code>
		</code></td>
		<td>
		Queries the editor for all the supported export formats for currently opened document.
		</td>
	</tr>

</table>
Getters response<br/>
Editor to WOPI host
<table data-id='postmessage-query-getters-resp'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Get_Views_Resp</b></code></td>
		<td><code>
		    <nobr>ViewId: &lt;Number&gt;</nobr>
		    <nobr>UserId: &lt;String&gt;</nobr>
		    <nobr>UserName: &lt;String&gt;</nobr>
		    <nobr>Color: &lt;Number&gt;</nobr>
		    <nobr>ReadOnly: &lt;Boolean&gt;</nobr>
		    <nobr>IsCurrentView: &lt;Boolean&gt;</nobr>
		</code></td>
		<td>Give details of all current views when queried using <code>Get_Views</code>
		</td>
	</tr>
	<tr>
		<td><code><b>Get_Export_Formats_Resp</b></code></td>
		<td><code>
		    <nobr>Label: &lt;String&gt;</nobr>
		    <nobr>Format: &lt;String&gt;</nobr>
		</code></td>
		<td>
		Response to query <code>Get_Export_Formats</code>.
		Label would contain a localised string explaining about the format.
		Format is the file extension of the format which is required while requesting
		export of the document.
		</td>
	</tr>
</table>

<h3 id="loleaflet-postmessage-sessions">Session Management</h3>
<h4>WOPI Host to editor</h4>
<table data-id='postmessage-sessions-management'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Action_RemoveView</b></code></td>
		<td><code>
			<nobr>ViewId: &lt;Number&gt;</nobr>
		</code></td>
		<td>Remove the session</code>.
		</td>
	</tr>
	</table>

<h4>Editor to WOPI Host</h4>
<table data-id='postmessage-sessions'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>View_Added</b></code></td>
		<td><code>
		    <nobr>ViewId: &lt;Number&gt;</nobr>
		    <nobr>UserId: &lt;String&gt;</nobr>
		    <nobr>UserName: &lt;String&gt;</nobr>
		    <nobr>Color: &lt;Number&gt;</nobr>
		    <nobr>ReadOnly: &lt;Boolean&gt;</nobr>
		    <nobr>Deprecated: true;</nobr>
		</code></td>
		<td>A new member is added. ViewId is unique integer
		identifying a session/view. UserId is user identity. UserName is
		display name of the user. Color is RGB color integer
		value. ReadOnly tells if the new view is opened as readonly.<br/>
		This message is <strong>deprecated</strong>, instead implement just
		handling of Views_List which holds the same payload as
		<code>Get_Views_Resp</code>.
		</td>
	</tr>
	<tr>
		<td><code><b>View_Removed</b></code></td>
		<td><code>
		    <nobr>ViewId: &lt;Number&gt;</nobr>
		    <nobr>Deprecated: true;</nobr>
		</code></td>
		<td>View with <code>ViewId</code> has closed the document.<br/>
		This message is <strong>deprecated</strong>, instead implement just
		handling of Get_Views_Resp and if you need the info which view has
		been added / removed, check against the previous state.<br/>
		This message is <strong>deprecated</strong>, instead implement just
		handling of Views_List which holds the same payload as
		<code>Get_Views_Resp</code>.
		</td>
	</tr>
	<tr>
		<td><code><b>Views_List</b></code></td>
		<td>See <code>Get_Views_Resp</code>.</td>
		<td>Complete information about the currently connected views.
		</td>
	</tr>
	</table>

<h3 id="loleaflet-postmessage-actions">Actions</h3>
<h4>WOPI host to editor</h4>
<table data-id='postmessage-actions'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Action_Save</b></code></td>
		<td><code>
		    <nobr>DontTerminateEdit: &lt;boolean&gt;</nobr>
		    <nobr>DontSaveIfUnmodified: &lt;boolean&gt;</nobr>
		    <nobr>Notify: &lt;boolean&gt;</nobr>
		    <nobr>ExtendedData: &lt;String&gt;</nobr>
		</code></td>
		<td>Saves the document.<br/>
		<code>DontTerminateEdit</code> is relevant for spreadsheets where saving
		a document can terminate the edit mode (text cursor dissappearing). Setting this to
		true won't terminate the edit mode and can be used to save document without disrupting
		user's editing session in spreadsheets.<br/>
		<code>DontSaveIfUnmodified</code> prevents loolwsd to save the file back to storage if document is
		unmodified (only cursor position changed etc.) but still saved. This can be helpful
		to prevent creating unnecessary file revisions.<br/>
		<code>Notify</code> when present and set to true notifies the
		host when document is saved. See <code>Action_Save_Resp</code>
		for details.<br/>
		<code>ExtendedData</code> optional data carried over to the WOPI host if provided
		in the X-LOOL-WOPI-ExtendedData header. The contents are preserved as-is,
		however, care must be taken to avoid using anything that HTTP headers do
		not allow, also, special values such as new-line, null character, non-printable
		characters, etc. are not allowed. The client can use this to pass multiple values
		to the WOPI host which can then act on them.<br/>
		</td>
	</tr>
	<tr>
		<td><code><b>Action_SaveAs</b></code></td>
		<td><code>
		    <nobr>Filename: &lt;String&gt;</nobr>
		    <nobr>Notify: &lt;boolean&gt;</nobr>
		</code></td>
		<td>Creates copy of the document with given Filename.<br/>
		<code>Filename</code> is the requested filename for the new file.<br/>
		<code>Notify</code> when present and set to true notifies the
		host when document is saved. See <code>Action_Save_Resp</code>
		for details.
		</td>
	</tr>
	<tr>
		<td><code><b>Action_FollowUser</b></code></td>
		<td><code>
			<nobr>Follow: &lt;Boolean&gt;</nobr>
			<nobr>ViewId: &lt;Number&gt;</nobr>
		</code></td>
		<td>Turn on or off the follow user feature.<br/>
		When <code>Follow</code> is set to true or is not defined enables following the editor, disables following when set to false.<br/>
		When <code>Follow</code> is set to true or is not defined <code>ViewId</code> parameter specifies user to follow. When <code>ViewId</code> is not defined, the current editor is followed.<br/>
		</td>
	</tr>
	<tr>
		<td><code><b>Action_Close</b></code></td>
		<td><code>
		</code></td>
		<td>
		Closes the document.
		</td>
	</tr>
	<tr>
		<td><code><b>Action_Print</b></code></td>
		<td><code>
		</code></td>
		<td>
		Prints the document.
		</td>
	</tr>
	<tr>
		<td><code><b>Action_Export</b></code></td>
		<td><code>
		    <nobr>Format: &lt;String&gt;</nobr>
		</code></td>
		<td>
		Downloads the document in format specified by <code>Format</code>. Format must be from the list returned
		in <code>Get_Export_Formats</code>
		</td>
	</tr>
	<tr>
		<td><code><b>Action_InsertGraphics</b></code></td>
		<td><code>
		    <nobr>url: &lt;String&gt;</nobr>
		</code></td>
		<td>
		Downloads image from the url and inserts it to the document.
		</td>
	</tr>
	<tr>
		<td><code><b>Action_Paste</b></code></td>
		<td><code>
		    <nobr>Mimetype: &lt;String&gt;</nobr>
		    <nobr>Data: &lt;String&gt;</nobr>
		</code></td>
		<td>
		Pastes the Data with the given Mimetype at the current cursor
		position. This works around the copy/paste mechanism that is
		in Collabora Online, and pastes the data directly to the
		document.
		</td>
	</tr>
	<tr>
		<td><code><b>Action_ShowBusy</b></code></td>
		<td><code>
		    <nobr>Label: &lt;String&gt;</nobr>
		</code></td>
		<td>
		Shows an in-progress overlay, just like what appears when saving
		the document, with the given Label.
		</td>
	</tr>
	<tr>
		<td><code><b>Action_HideBusy</b></code></td>
		<td/>
		<td>
                Hides any in-progress overlay, if present.
		</td>
	</tr>
</table>

<h4>WOPI editor to host (Response)</h4>
<table data-id='postmessage-actions-response'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Action_Load_Resp</b></code></td>
		<td><code>
			<nobr>success: &lt;boolean&gt;</nobr>
			<nobr>result: &lt;string&gt;</nobr>
			<nobr>errorMsg: &lt;string&gt;</nobr>
		</code></td>
		<td>Acknowledgement when load finishes.<br/>
		<code>success</code> tells if LOOL was able to load the document
		successfully.<br/>
		<code>result</code> contains the reason the document was not loaded.<br/>
		<code>errorMsg</code> contains a detailed error message in case loading failed.
		Probably it will contain the error message returned from the WOPI host.
		</td>
	</tr>

	<tr>
		<td><code><b>Action_Save_Resp</b></code></td>
		<td><code>
		    <nobr>success: &lt;boolean&gt;</nobr>
		    <nobr>result: &lt;string&gt;</nobr>
			<nobr>errorMsg: &lt;string&gt;</nobr>
			<nobr>fileName: &lt;string&gt;</nobr>
		</code></td>
		<td>Acknowledgement when save finishes.<br/>
		<i>This response is only emitted if <code>Notify</code> parameter
		is mentioned by <code>Action_Save</code> PostMessage API.</i>
		<br/>
		<code>success</code> tells if LOOL was able to save the document
		successfully.<br/>
		<code>result</code> contains the reason the document was not saved.<br/>
		In case, document was not saved because it was not modified,
		then this parameter contains the string 'unmodified'. In this
		case, WOPI hosts can be sure that there are no changes pending
		in the document to be saved to the storage.<br/>
		<code>errorMsg</code> contains a detailed error message in case saving failed.
		Probably it will contain the error message returned from the WOPI host.<br/>
		<code>fileName</code> if success equals true then contains saved file name.
		</td>
	</tr>
	<tr>
		<td><code><b>FollowUser_Changed</b></code></td>
		<td><code>
			<nobr>FollowedViewId: &lt;Number&gt;</nobr>
			<nobr>IsFollowUser: &lt;Boolean&gt;</nobr>
			<nobr>IsFollowEditor: &lt;Boolean&gt;</nobr>
		</code></td>
		<td>Notification about current following state.<br/>
		<code>FollowedViewId</code> tells which user is followed. <code>IsFollowUser</code> determines if following the specific user is
		activated. <code>IsFollowEditor</code> determines if following the editor is
		activated. If both <code>IsFollowUser</code> and <code>IsFollowEditor</code> are false then following is
		inactive.
		</td>
	</tr>
</table>

<h3 id="loleaflet-postmessage-versioning">Version Restore</h3>
<h4>WOPI host to editor</h4>
<table data-id="postmessage-versioning-to-editor">
    <tr>
	<th>MessageId</th>
	<th>Values</th>
	<th>Description</th>
    </tr>
    <tr>
	<td><code><b>Host_VersionRestore</b></code></td>
	<td><code>
	    <nobr>Status: &lt;string&gt;</nobr>
	</code></td>
	<td>
	    Only possible value of Status (for now) is <code>Pre_Restore</code>.
	    This message is sent by the host <b>before</b> actually restoring the document
	    and <b>after</b> user showed the intent to restore the document. This is so such
	    that if there are any unsaved changes, Online can save them to storage before
	    document is restored.
	</td>
    </tr>
</table>

<h4>Editor to WOPI host</h4>
<table data-id="postmessage-versioning-to-host">
    <tr>
	<th>MessageId</th>
	<th>Values</th>
	<th>Description</th>
    </tr>
    <tr>
	<td><code><b>App_VersionRestore</b></code></td>
	<td><code>
	    <nobr>Status: &lt;string&gt;</nobr>
	</code></td>
	<td>
	    This is the reply for the Host_VersionRestore message. Possible values for <code>Status</code>
	    (for now) is: <code>Pre_Restore_Ack</code>. It means that host can go ahead with restoring the
	    document to an earlier revision.
	</td>
    </tr>
</table>

<h5>Note</h5>
<p>These messages are only emitted if <i>App_LoadingStatus</i> contains <i>VersionStates</i> in <i>Features</i>. Otherwise, host can immediately restore the version to earlier revision.</p>

<h3 id='loleaflet-postmessage-misc'>Miscellaneous</h3>
<h4>WOPI host to editor</h4>
<table data-id='postmessage-misc-to-editor'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Insert_Button</b></code></td>
		<td><code>
		    <nobr>id: &lt;string&gt;</nobr><br/>
		    <nobr>imgurl: &lt;string&gt;</nobr><br/>
		    <nobr>hint: &lt;string&gt;</nobr><br/>
		    <nobr>mobile: &lt;boolean&gt;</nobr><br/>
		    <nobr>label: &lt;string&gt;</nobr><br/>
		    <nobr>insertBefore: &lt;string&gt;</nobr><br/>
		    <nobr>unoCommand: &lt;string&gt;</nobr><br/>
		</code></td>
		<td>
		  Inserts a button to the top toolbar.

		  It responds with <code>Clicked_Button</code> post message event
		  on which hosts can react accordingly
		  (except when the <code>unoCommand</code> property is set).<br/>
		  <code>id</code> parameter is a unique id of the toolbar
		  button. It is recommended to prefix such ids given here with
		  some host namespace so that it doesn't conflict with existing
		  toolbar IDs. In case of conflict, button is not added.<br/>
		  <code>imgurl</code> parameter is the link to the image that
		  will be set as button image in the toolbar. The ideal size of
		  the image is 24x24px. The image must be hosted on the host URL
		  to not violate Content-Security-Policy.<br/>
		  <code>hint</code> This is used as a tooltip of the
		  button.<br/>
		  <code>mobile</code> Whether the button should be shown when
		  the interface switches to mobile mode.<br/>
		  <code>label</code> When a readonly document is opened, we
		  don't have the toolbar at all. In this case, this newly added
		  button is present in file menubar. The text against this label
		  is used as text of the menubar item.<br/>
		  <code>insertBefore</code> Specify the position where the button
		  should be inserted.
		  <code>insertBefore</code> is the button ID (see <a href="#toolbar-button-ids">Finding toolbar button IDs</a>).
		  <code>unoCommand</code> UNO Command to be executed on button click
		  (<a href="https://wiki.documentfoundation.org/Development/DispatchCommands">Reference</a>). When this property
		  is set, no 'Clicked_Button' response is sent. The button click will be handled by LibreOffice.
		</td>
	</tr>
	<tr>
		<td><code><b>Hide_Button</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Hides a button from the toolbar.<br/>
		    <code>id</code> is the button ID (see <a href="#toolbar-button-ids">Finding toolbar button IDs</a>).
		</td>
	</tr>
	<tr>
		<td><code><b>Show_Button</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Hides a button from the toolbar.<br/>
			<code>id</code> is the button ID (see <a href="#toolbar-button-ids">Finding toolbar button IDs</a>).
		</td>
	</tr>
	<tr>
		<td><code><b>Remove_Button</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Removes a button from the toolbar.<br/>
		    <code>id</code> is the button ID (see <a href="#toolbar-button-ids">Finding toolbar button IDs</a>).
		</td>
	</tr>
	<tr>
		<td><code><b>Remove_Statusbar_Element</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Removes an element from the statusbar.<br/>
		    <code>id</code> is the element ID (see <a href="#statusbar-element-ids">Finding statusbar element IDs</a>).
		</td>
	</tr>
	<tr>
		<td><code><b>Hide_Menubar</b></code></td>
		<td></td>
		<td>
			Hides the menu bar.
		</td>
	</tr>
	<tr>
		<td><code><b>Show_Menubar</b></code></td>
		<td></td>
		<td>
			Shows the menu bar.
		</td>
	</tr>
	<tr>
		<td><code><b>Grab_Focus</b></code></td>
		<td></td>
		<td>
			This restores focus to the application, activating it, and removing any overlay
		indicating quiescence, and re-connecting to the server if necessary. Useful after leaving
		the application for a lengthy period, or when wanting to restore browser focus after
		presenting an overlayed dialog.
		</td>
	</tr>
		<td><code><b>Hide_Ruler</b></code></td>
		<td></td>
		<td>
			Hides the horizontal document ruler (Writer only)
		</td>
	</tr>
	<tr>
		<td><code><b>Show_Ruler</b></code></td>
		<td></td>
		<td>
			Shows the horizontal document ruler (Writer only)
		</td>
	</tr>
	<tr>
		<td><code><b>Hide_Button</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Hides a button from the toolbar.<br/>
		    <code>id</code> is the button ID, see <a href="#toolbar-button-ids">Finding toolbar button IDs</a>.
		</td>
	</tr>
	<tr>
		<td><code><b>Show_Button</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Shows a button from the toolbar.<br/>
		    <code>id</code> is the button ID, see <a href="#toolbar-button-ids">Finding toolbar button IDs</a>.
		</td>
	</tr>
	<tr>
		<td><code><b>Hide_Menu_Item</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Hides an item from the menu.<br/>
			<code>id</code> is the item ID as defined in the
			<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.Menubar.js">loleaflet/src/control/Control.Menubar.js</a>.
		</td>
	</tr>
	<tr>
		<td><code><b>Show_Menu_Item</b></code></td>
		<td>
			<code><nobr>id: &lt;string&gt;</nobr></code>
		</td>
		<td>
			Shows an item from the menu.<br/>
			<code>id</code> is the item ID as defined in the
			<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.Menubar.js">loleaflet/src/control/Control.Menubar.js</a>.
		</td>
	</tr>
	<tr>
		<td><code><b>Disable_Default_UIAction</b></code></td>
		<td>
			<code><nobr>action: &lt;string&gt;</nobr></code>
			<code><nobr>disable: &lt;Boolean&gt;</nobr></code>
		</td>
		<td>
			Disable the default handler and action for a UI command.<br/>

			<code>action</code> is the action name to enable/disable the
			default action for.<br/>

			<code>disable</code> controls whether to disable (true) or
			enable (false) the default action.<br/>

			When set to true, the given UI command will only issue a postMessage
			without invoking the default action, leaving it up to the client
			to intercept the postMessage event and handle as necessary.
			Notice that some actions do not have any default handler to
			begin with (such as UI_SaveAs and UI_Share) and therefore this
			will have no effect on them; they only issue postMessage notification
			anyway without taking any action beyond that.<br/>

			For example, UI_Save will be issued for invoking the save
			command (from the menu, toolbar, or keyboard shortcut) and no
			action will take place if 'UI_Save' is disabled via
			the Disable_Default_UIAction command. Clients who disable
			UI_Save should then issue Action_Save themselves, when and
			if they desire to save the document.
			Similarly, when disabling UI_Close, the document will not
			close upon invoking the UI_Close action, instead a postMessage
			notification will be issued and it will be up to the client
			to issue Action_Close when they desire.<br/>

			Clients must be careful not to issue duplicate actions when
			the default handler is enabled, instead, they should only
			issue actions themselves when the default is disabled.

			Note: currently only UI_Save and UI_Close are supported.<br/>
		</td>
	</tr>
</table>

<h5><a name="toolbar-button-ids">Finding toolbar button IDs</a></h5>
<p>Toolbar button IDs are defined in getToolItems/create functions in:
<ul>
	<li>
		<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.TopToolbar.js">Control.TopToolbar.js</a> for the top toolbar on desktop or tablet.
	</li>
	<li>
		<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.MobileTopBar.js">Control.MobileTopBar.js</a> for the top toolbar on smartphone.
	</li>
	<li>
		<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.MobileBottomBar.js">Control.MobileBottomBar.js</a> for the bottom toolbar on smartphone.
	</li>
	<li>
		<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.StatusBar.js">Control.StatusBar.js</a> for the statusbar on desktop.
	</li>
</ul>
Note that they usually don't change but there is no guarantee that they are stable.</p>

<h5><a name="statusbar-element-ids">Finding statusbar element IDs</a></h5>
<p>Statusbar button IDs are defined in the onDocLayerInit function in
<a href="https://github.com/CollaboraOnline/online/blob/master/loleaflet/src/control/Control.StatusBar.js">Control.StatusBar.js</a>.
Note that they usually don't change but there is no guarantee that they are stable.</p>

<h4>Editor to WOPI host</h4>
<table data-id='postmessage-misc-to-host'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>Clicked_Button</b></code></td>
		<td><code>
		    <nobr>id: &lt;string&gt;</nobr>
		</code></td>
		<td>
		  This event is emitted when the custom button added
		  via <code>Insert_Button</code> API above is clicked.
		</td>
	</tr>
	<tr>
		<td><code><b>Download_As</b></code></td>
		<td><code>
			<nobr>Type: 'print'|'slideshow'|'export'</nobr><br/>
			<nobr>URL: &lt;string&gt;</nobr><br/>
		</code></td>
		<td>
		  This event is emitted when the user chooses 'Print' or 'Show
		  slideshow' or 'Download As [some type'] and the integration
		  indicates via DownloadAsPostMessage in the CheckFileInfo that it
		  wants to handle the downloading of pdf for printing or svg for
		  slideshows or experted document.

		  This is in situations when the integration cannot rely on browser's
		  support for downloading like in mobile apps that use the Online in
		  a WebView.
		</td>
	</tr>
	<tr>
		<td><code><b>UI_CreateFile</b></code></td>
		<td></td>
		<td>
		Requests WOPI host to open a new browser tab and create a new
		document.  The document type is passed as DocumentType
		argument, and cand be 'text', 'spreadsheet', 'presentation' or
		'drawing'.
		</td>
	</tr>
	<tr>
		<td><code><b>UI_SaveAs</b></code></td>
		<td></td>
		<td>
		Requests WOPI host to create appropriate UI, so that the user can choose
		path and File name for creating a copy of the current file.
		Response to this query is sent via <code>Action_SaveAs</code> message.
		</td>
	</tr>
	<tr>
		<td><code><b>UI_Cancel_Password</b></code></td>
		<td></td>
		<td>
		Notifies WOPI host that the user clicked on the 'cancel' option when opening
		a password protected file, instead of providing the password to decrypt it.
		</td>
	</tr>
	<tr>
		<td><code><b>UI_Hyperlink</b></code></td>
		<td></td>
		<td>
		Notifies WOPI host that the user clicked a hyperlink and
		confirmed they really want to leave the document to follow the
		hyperlink.</br>
		This is especially useful for integrations that
		embed Collabora Online into an iframe in a mobile app, where
		actually trying to open a new window should trigger starting a
		new Activity on Android (or something similar on iOS).</br>
		The integration using this most probably also wants to trigger
		the <b>Disable_Default_UIAction</b> for UI_Hyperlink.
		</td>
	</tr>
	<tr>
		<td><code><b>Doc_ModifiedStatus</b></code></td>
		<td></td>
		<td>
		Notification to update the modified status of the document.
		Values.Modified will be true, if the document has been modified
		since the last save, otherwise, it will be false if the document
		has been saved.

		Note that this notification may be published without a change
		from the prior value, so care must be taken to check the Values.Modified
		value and not assume the notification itself implies the
		modified state of the document on its own.
		</td>
	</tr>
</table>

<h3 id='loleaflet-postmessage-python'>Calling Python scripts</h3>
<h4>WOPI host to editor</h4>
<table data-id='postmessage-python-to-editor'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>CallPythonScript</b></code></td>
		<td><code>
		    <nobr>ScriptFile: &lt;string&gt;</nobr><br/>
		    <nobr>Function: &lt;string&gt;</nobr>
		    <nobr>Values: &lt;object&gt;</nobr>
		</code></td>
		<td>
		  Calls a Python script. The Values parameter contains an
		  object with named parameters that are passed to the script.
		</td>
	</tr>
</table>

<h4>Editor to WOPI host</h4>
<table data-id='postmessage-python-to-host'>
	<tr>
		<th>MessageId</th>
		<th>Values</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code><b>CallPythonScript-Result</b></code></td>
		<td><code>
		    <nobr>commandName: &lt;string&gt;</nobr>
		    <nobr>Values: &lt;object&gt;</nobr>
		</code></td>
		<td>
		  Returns the result of a Python script. The URL of the script called
		  is in the commandName parameter.
		</td>
	</tr>
</table>



</div>
<script>
	hljs.configure({tabReplace: '    '});
	hljs.initHighlighting();

	(function () {
		if (document.body.className.indexOf('api-page') !== -1) {
			var headers = document.getElementsByTagName('h2');

			for (var i = 0, len = headers.length; i < len; i++) {
				if (headers[i].id) {
					headers[i].onclick = function(e) {
						if (e.offsetX < 0) {
							window.location.hash = '#' + this.id;
						}
					};
				}
			}
		}
	})();
</script>

<script>
var unoCommands = [
{
    header: 'Global operations',
},

{
    uno: '.uno:Redo',
    parameter: null,
    description: 'Redo.'
},

{
    uno: '.uno:Save',
    parameter: null,
    description: 'Save the document.'
},

{
    uno: '.uno:Undo',
    parameter: null,
    description: 'Undo.'
},

{
    header: 'Text formatting',
},

{
    uno: '.uno:BackColor',
    parameter: {
        'BackColor': {
            type: 'long',
            value: 16750848
        }
    },
    description: 'Apply a highlighting color for a text document (the value can be obtained by converting the base 16 color to base 10).'
},

{
    uno: '.uno:CharBackgroundExt',
    parameter: null,
    description: '.uno:CharBackgroundExt is supplementary to .uno:BackColor. When .uno:BackColor is set, Writer turns into a "watercan" mode, where the user directly marks parts of the text with the wanted background color. ' +
                 '.uno:CharBackgroundExt then controls this watercan mode - dispatching it toggles the watercan mode on/off, and also the StateChanged events reflect the on/off mode accordingly.'
},

{
    uno: '.uno:BackgroundColor',
    parameter: {
        'BackgroundColor': {
            type: 'long',
            value: 16750848
        }
    },
    description: 'Apply a highlighting color for a spreadsheet document (the value can be obtained by converting the base 16 color to base 10).'
},

{
    uno: '.uno:Bold',
    parameter: null,
    description: 'Bold.'
},

{
    uno: '.uno:CharBackColor',
    parameter: {
        'CharBackColor': {
            type: 'long',
            value: 16750848
        }
    },
    description: 'Apply a font color for a presentation document (the value can be obtained by converting the base 16 color to base 10).'
},

{
    uno: '.uno:CharFontName',
    parameter: {
        'CharFontName.FamilyName': {
            type: 'string',
            value: 'Arial'
        }
    },
    description: 'Apply font.'
},

{
    uno: '.uno:Color',
    parameter: {
        'Color': {
            type: 'long',
            value: 16750848
        }
    },
    description: 'Apply a font color for a non-text document, like a spreadsheet, presentation, etc (the value can be obtained by converting the base 16 color to base 10).'
},

{
    uno: '.uno:FontColor',
    parameter: {
        'FontColor': {
            type: 'long',
            value: 16750848
        }
    },
    description: 'Apply a font color for a text document (the value can be obtained by converting the base 16 color to base 10).'
},

{
    uno: '.uno:FontHeight',
    parameter: {
        'FontHeight.Height': {
            type: 'float',
            value: '11.5'
        }
    },
    description: 'Apply font size.'
},

{
    uno: '.uno:Italic',
    parameter: null,
    description: 'Italic.'
},

{
    uno: '.uno:OutlineFont',
    parameter: null,
    description: 'Outline.'
},

{
    uno: '.uno:Shadowed',
    parameter: null,
    description: 'Shadowed.'
},

{
    uno: '.uno:SubScript',
    parameter: null,
    description: 'Subscript.'
},

{
    uno: '.uno:SuperScript',
    parameter: null,
    description: 'Superscript.'
},

{
    uno: '.uno:Strikeout',
    parameter: null,
    description: 'Strikeout / strike-through.'
},

{
    uno: '.uno:Underline',
    parameter: null,
    description: 'Underline.'
},

{
    header: 'Paragraph formatting',
},

{
    uno: '.uno:CenterPara',
    parameter: null,
    description: 'Center horizontally.'
},

{
    uno: '.uno:DecrementIndent',
    parameter: null,
    description: 'Decrement paragraph indentation.'
},

{
    uno: '.uno:DefaultBullet',
    parameter: null,
    description: 'Bullets ON/OFF.'
},

{
    uno: '.uno:DefaultNumbering',
    parameter: null,
    description: 'Numbering ON/OFF.'
},

{
    uno: '.uno:IncrementIndent',
    parameter: null,
    description: 'Increment paragraph indentation.'
},

{
    uno: '.uno:JustifyPara',
    parameter: null,
    description: 'Justified.'
},

{
    uno: '.uno:LeftPara',
    parameter: null,
    description: 'Align left.'
},

{
    uno: '.uno:RightPara',
    parameter: null,
    description: 'Align right.'
},

{
    uno: '.uno:SetHyperlink',
    parameter: {
        'Hyperlink.Text': {
            type: 'string',
            value: 'some text'
        },
        'Hyperlink.URL': {
            type: 'string',
            value: 'url'
        }
    },
    description: 'Creates a hyperlink. If Hyperlink.Text is not specified, the hyperlink will be set for the current ' +
                     'selection. Hyperlink.URL can be a web URL or a bookmark from the document.'
},

{
    header: 'Comments',
},

{
    uno: '.uno:DeleteComment',
    parameter: null,
    description: 'Delete comment.'
},

{
    uno: '.uno:InsertAnnotation',
    parameter: {
        'Author': {
            type: 'string',
            value: 'A U Thor'
        }
    },
    description: 'Insert comment.'
},

{
    header: 'Fields',
},

{
    uno: '.uno:InsertPageNumberField',
    parameter: null,
    description: 'Insert Page Number field.'
},

{
    uno: '.uno:InsertPageCountField',
    parameter: null,
    description: 'Insert Page Count field.'
},

{
    uno: '.uno:DateField',
    parameter: null,
    description: 'Insert Date field.'
},

{
    uno: '.uno:TimeField',
    parameter: null,
    description: 'Insert Time field.'
},

{
    uno: '.uno:TitleField',
    parameter: null,
    description: 'Insert Title field.'
},

{
    uno: '.uno:AuthorField',
    parameter: null,
    description: 'Insert Author field.'
},

{
    uno: '.uno:TopicField',
    parameter: null,
    description: 'Insert Topic field.'
},

{
    header: 'Styles',
},

{
    uno: '.uno:DeleteStyle',
    parameter: null,
    description: 'Delete the current style.'
},

{
    uno: '.uno:FormatPaintbrush',
    parameter: null,
    description: 'Copy format of the selected text to another text.'
},

{
    uno: '.uno:ResetAttributes',
    parameter: null,
    description: 'Clear direct formatting.'
},

{
    uno: '.uno:StyleApply',
    parameter: {
        'Style': {
            type: 'string',
            value: 'Title'
        },
        'FamilyName': {
            type: 'string',
            value: 'ParagraphStyles'
        }
    },
    description: 'Apply style from style family.'
},

{
    uno: '.uno:StyleUpdateByExample',
    parameter: null,
    description: 'Update the current style to match the selected text.'
},

{
    header: 'Tables (in a text document)',
},

{
    uno: '.uno:InsertColumnsAfter',
    parameter: null,
    description: 'Insert column after the current cursor position.',
},

{
    uno: '.uno:InsertColumnsBefore',
    parameter: null,
    description: 'Insert column before the current cursor position.',
},

{
    uno: '.uno:InsertRowsAfter',
    parameter: null,
    description: 'Insert row after the current cursor position.',
},

{
    uno: '.uno:InsertRowsBefore',
    parameter: null,
    description: 'Insert row before the current cursor position.',
},

{
    uno: '.uno:InsertTable',
    parameter: {
	'Columns': {
		'type': 'long',
		'value': 6
	},
	'Rows': {
		'type': "long",
		'value': 10
	}
    },
    description: 'Insert table with the given dimensions.'
},

{
    uno: '.uno:DeleteTable',
    parameter: null,
    description: 'Delete table at the current cursor position.'
},

{
    uno: '.uno:DeleteColumns',
    parameter: null,
    description: 'Delete the current column.'
},

{
    uno: '.uno:DeleteRows',
    parameter: null,
    description: 'Delete the current row.'
},

{
    header: 'Tables (in presentations)',
},

{
    uno: '.uno:InsertColumns',
    parameter: null,
    description: 'Insert column after the current cursor position.',
},

{
    uno: '.uno:InsertRows',
    parameter: null,
    description: 'Insert row after the current cursor position.',
},

{
    uno: '.uno:InsertTable',
    parameter: {
	'Columns': {
		'type': 'long',
		'value': 6
	},
	'Rows': {
		'type': "long",
		'value': 10
	}
    },
    description: 'Insert table with the given dimensions.'
},

{
    uno: '.uno:DeleteColumns',
    parameter: null,
    description: 'Delete the current column.'
},

{
    uno: '.uno:DeleteRows',
    parameter: null,
    description: 'Delete the current row.'
},

{
    header: 'Text document-related',
},

{
    uno: '.uno:UpdateAllIndexes',
    parameter: null,
    description: 'Update all Table of X (Content etc.)  Useful for general menus / toolbars.'
},

{
    uno: '.uno:UpdateCurIndex',
    parameter: null,
    description: 'Update the current Table of X (Content etc.)  "Current" means the one in where the cursor is located, useful for context menus.'
},

{
    header: 'Spreadsheet-related',
},

{
    uno: '.uno:DeleteColumns',
    parameter: null,
    description: 'Delete the current column.'
},

{
    uno: '.uno:DeleteRows',
    parameter: null,
    description: 'Delete the current row.'
},

{
    uno: '.uno:EnterString',
    parameter: {
        'StringName': {
            type: 'string',
            value: '=SUM()'
        }
    },
    description: 'Enters the string in the selected cell.'
},

{
    uno: '.uno:Insert',
    parameter: {
        'Name': {
            'type': 'string',
            'value': 'Sheet Name'
        },
        'Index': {
            'type': 'long',
            'value': 0
        }
    },
    description: 'Inserts a new sheet to the spreadsheet. The "Name" parameter can be left as empty string, in that case the sheet name will be generated. The "Index" parameter means the position where it should be inserted - "1" means adding as the 1st sheet, etc. 0 is special, and means adding as the last sheet.'
},

{
    uno: '.uno:InsertColumns',
    parameter: null,
    description: 'Insert column after the current cursor position.',
},

{
    uno: '.uno:InsertRows',
    parameter: null,
    description: 'Insert row before the current cursor position.',
},

{
    uno: '.uno:Name',
    parameter: {
        'Name': {
            'type': 'string',
            'value': 'Sheet Name'
        },
        'Index': {
            'type': 'long',
            'value': 1
        }
    },
    description: 'Rename the given sheet in the spreadsheet. The "Index" parameter means the position of the sheet - "1" means the 1st sheet, etc.'
},

{
    uno: '.uno:Remove',
    parameter: {
        'Index': {
            'type': 'long',
            'value': 5
        }
    },
    description: 'Remove the given sheet from the spreadsheet. The "Index" parameter means the position - "1" means the 1st sheet, etc.'
},

{
    uno: '.uno:SortAscending',
    parameter: null,
    description: 'Sort the current selection ascending.'
},

{
    uno: '.uno:SortDescending',
    parameter: null,
    description: 'Sort the current selection descending.'
},

{
    header: 'Presentation-related',
},

{
    uno: '.uno:AssignLayout',
    parameter: {
        'WhatLayout': {
            'type': 'long',
            'value': 19
        }
    },
    description: 'Changes the layout of the current slide.  Possible values of "WhatLayout" are: <ul>' +
	'<li>20 - Blank</li>' +
	'<li>19 - Title</li>' +
	'<li>0 - Title, Text</li>' +
	'<li>1 - Title, Content</li>' +
	'<li>32 - Centered Text</li>' +
	'<li>3 - Title, 2 Content</li>' +
	'<li>12 - Title, Content and 2 Content on Right</li>' +
	'<li>15 - Title, 2 Content on Left and Content</li>' +
	'<li>14 - Title, Content above Content</li>' +
	'<li>16 - Title, 2 Content above Content</li>' +
	'<li>18 - Title, 4 Content</li>' +
	'<li>34 - Title, 6 Content</li>' +
	'<li>28 - Title, Content (Vertical)</li>' +
	'<li>27 - Title, Content over Content (Vertical)</li>' +
	'<li>29 - Title, Vertical Content</li>' +
	'<li>30 - Title, 2 Vertical Content</li></ul>'
},

{
    header: 'Appearance options',
},

{
    uno: '.uno:HideWhitespace',
    parameter: {
        'type': 'boolean',
        'value': 'false'
    },
    description: 'Continuous web view of the document.'
},

{
    uno: '.uno:ShowBorderShadow',
    parameter: {
        'type': 'boolean',
        'value': 'true'
    },
    description: 'Paint a shadow around Write page / Impress slide border.'
},

{
    header: 'Calling Python scripts',
},

{
    uno: 'vnd.sun.star.script:&lt;filename&gt;$&lt;function&gt;?language=Python&location=share',
    parameter: {
                                                               'sheet': {'type': 'string', 'value': 'Sheet1'},
								'x0': {'type': 'long', 'value': 1},
								'y0': {'type': 'long', 'value': 2},
								'width': {'type': 'long', 'value': 3},
								'height': {'type': 'long', 'value': 4},
								'name': {'type': 'string', 'value': 'Alice'}
    },
    description: 'Calls a Python script. The parameter example here are those taken by the DefineNamedRange function in the NamedRanges.py file.'
},

];
$(document).ready(function() {
    var table = $('#uno-commands-table');
    unoCommands.forEach(function (unoCommand) {
	if ('header' in unoCommand) {

            table.append(
                '<tr>' +
                '	<td colspan="3"><b>' + unoCommand.header + '</b></td>' +
                '</tr>');
	}
	else {
            table.append(
                '<tr>' +
                '	<td><code><b>' + unoCommand.uno + '</b></code></td>' +
                '	<td><code><pre>' + JSON.stringify(unoCommand.parameter, null, 2) + '</pre></code></td>' +
                '	<td>' + unoCommand.description + '</td>' +
                '</tr>');
	}
    });
});
</script>

<script type="text/javascript" src="docs/js/docs.js"></script>
</body>
</html>
